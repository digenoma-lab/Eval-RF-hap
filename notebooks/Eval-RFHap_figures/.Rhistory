)
b
c=ggplot(hg00_wg, aes(x = Assembly, y = N50gfastats, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(N50gfastats, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "N50 gfastats",
x = "Assembly",
y = "N50 gfastats",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
c
c=ggplot(hg00_wg, aes(x = Assembly, y = N50gfastats, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(N50gfastats, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "N50 gfastats",
x = "Assembly",
y = "N50 gfastats",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
c
e=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorMerqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(SwitchErrorMerqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 2.5) +
facet_wrap(~Dataset) +
labs(
title = "Merqury Switch Error",
x = "Assembly",
y = "Merqury Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
e
f=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorYak, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Dataset) +
labs(
title = "Yak Switch Error",
x = "Assembly",
y = "Yak Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),title = element_text(size = 10)
)
f
setwd("/mnt/beegfs/labs/DiGenomaLab/rfhap/analysis/figures_rfhap/Eval-RFHap_figures")
g = (a | b | c) / ( e | f ) + plot_layout(guides = "collect")
png("metrics.png", width = 2300 , height = 1000 , res = 180)
g
dev.off()
g = (a | b | c) / ( e | f ) + plot_layout(guides = "collect")
png("metrics.png", width = 2300 , height = 1800 , res = 180)
g
dev.off()
f=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorYak, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(SwitchErrorYak, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 2.5) +
facet_wrap(~Dataset) +
labs(
title = "Yak Switch Error",
x = "Assembly",
y = "Yak Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),title = element_text(size = 10)
)
f
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
b=ggplot(hg00_wg, aes(x = Assembly, y = AvgBlockSize, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
facet_wrap(~Dataset) +
geom_text(aes(label = round(AvgBlockSize, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
labs(
title = "Merqury Avg Block Size",
x = "Assembly",
y = "Avg Block Size",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
b
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = 0.5,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,
hjust=0.5# etiqueta encima de la barra
color = "black",
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,
hjust=0.5,# etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50merqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3, # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
b=ggplot(hg00_wg, aes(x = Assembly, y = AvgBlockSize, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
facet_wrap(~Dataset) +
geom_text(aes(label = round(AvgBlockSize, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
labs(
title = "Merqury Avg Block Size",
x = "Assembly",
y = "Avg Block Size",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
b
c=ggplot(hg00_wg, aes(x = Assembly, y = N50gfastats, fill = Method)) +
geom_bar(stat = "identity", position = "dodge", width = 2) +
geom_text(aes(label = round(N50gfastats, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "N50 gfastats",
x = "Assembly",
y = "N50 gfastats",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
c
g = (a | b | c) / ( e | f ) + plot_layout(guides = "collect")
png("metrics.png", width = 2500 , height = 1800 , res = 180)
g
dev.off()
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(N50merqury, 2)),
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
a = ggplot(hg00_wg, aes(x = Assembly, y = N50merqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Dataset) +
labs(
title = "Merqury N50 corrected",
x = "Assembly",
y = "Merqury N50 corrected",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
a
b=ggplot(hg00_wg, aes(x = Assembly, y = AvgBlockSize, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Dataset) +
labs(
title = "Merqury Avg Block Size",
x = "Assembly",
y = "Avg Block Size",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
b
c=ggplot(hg00_wg, aes(x = Assembly, y = N50gfastats, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(N50gfastats, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 1.8) +
facet_wrap(~Dataset) +
labs(
title = "N50 gfastats",
x = "Assembly",
y = "N50 gfastats",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
c
c=ggplot(hg00_wg, aes(x = Assembly, y = N50gfastats, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~Dataset) +
labs(
title = "N50 gfastats",
x = "Assembly",
y = "N50 gfastats",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
c
e=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorMerqury, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(SwitchErrorMerqury, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 2.5) +
facet_wrap(~Dataset) +
labs(
title = "Merqury Switch Error",
x = "Assembly",
y = "Merqury Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), title = element_text(size = 10)
)
e
f=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorYak, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(SwitchError, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 2.5) +
facet_wrap(~Dataset) +
labs(
title = "Yak Switch Error",
x = "Assembly",
y = "Yak Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),title = element_text(size = 10)
)
f
f=ggplot(hg00_wg, aes(x = Assembly, y = SwitchErrorYak, fill = Method)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(SwitchErrorYak, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3,        # etiqueta encima de la barra
color = "black",
size = 2.5) +
facet_wrap(~Dataset) +
labs(
title = "Yak Switch Error",
x = "Assembly",
y = "Yak Switch Error",
fill = "Method"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),title = element_text(size = 10)
)
f
g = (a | b | c) / ( e | f ) + plot_layout(guides = "collect")
png("metrics.png", width = 2300 , height = 1800 , res = 180)
g
dev.off()
library(dplyr)
library(ggplot2)
no_norm_trainv03_hg001 = read.delim("no_normalization/HG001_predicted_class.txt", header = TRUE, sep = " ")
no_norm_trainv03_hg002 = read.delim("no_normalization/HG002_predicted_class.txt", header = TRUE, sep = " ")
no_norm_trainv03_hg005 = read.delim("no_normalization/HG005_predicted_class.txt", header = TRUE, sep = " ")
colnames(no_norm_trainv03_hg001)[1] = "read_id"
colnames(no_norm_trainv03_hg001)[2] = "no_norm_trainv03"
colnames(no_norm_trainv03_hg002)[1] = "read_id"
colnames(no_norm_trainv03_hg002)[2] = "no_norm_trainv03"
colnames(no_norm_trainv03_hg005)[1] = "read_id"
colnames(no_norm_trainv03_hg005)[2] = "no_norm_trainv03"
head(no_norm_trainv03_hg001)
no_norm_all <- bind_rows(
no_norm_trainv03_hg001 %>% mutate(dataset = "HG001"),
no_norm_trainv03_hg002 %>% mutate(dataset = "HG002"),
no_norm_trainv03_hg005 %>% mutate(dataset = "HG005")
)
head(no_norm_all)
norm_trainv03_hg001 = read.delim("normalization/HG001_predicted_class.txt", header = TRUE, sep = " ")
norm_trainv03_hg002 = read.delim("normalization/HG002_predicted_class.txt", header = TRUE, sep = " ")
norm_trainv03_hg005 = read.delim("normalization/HG005_predicted_class.txt", header = TRUE, sep = " ")
colnames(norm_trainv03_hg001)[1] = "read_id"
colnames(norm_trainv03_hg001)[2] = "norm_trainv03"
colnames(norm_trainv03_hg002)[1] = "read_id"
colnames(norm_trainv03_hg002)[2] = "norm_trainv03"
colnames(norm_trainv03_hg005)[1] = "read_id"
colnames(norm_trainv03_hg005)[2] = "norm_trainv03"
norm_all <- bind_rows(
norm_trainv03_hg001 %>% mutate(dataset = "HG001"),
norm_trainv03_hg002 %>% mutate(dataset = "HG002"),
norm_trainv03_hg005 %>% mutate(dataset = "HG005")
)
head(norm_all)
trio_binning_hg001 = read.delim("../../trio_binning/hg001_triobinning_prediction.tsv", header =FALSE, sep = "\t")
trio_binning_hg002 = read.delim("../../trio_binning/hg002_triobinning_prediction.tsv", header =FALSE, sep = "\t")
trio_binning_hg005 = read.delim("../../trio_binning/hg005_triobinning_prediction.tsv", header =FALSE, sep = "\t")
colnames(trio_binning_hg001)[1] = "read_id"
colnames(trio_binning_hg001)[2] = "trio_binning"
colnames(trio_binning_hg002)[1] = "read_id"
colnames(trio_binning_hg002)[2] = "trio_binning"
colnames(trio_binning_hg005)[1] = "read_id"
colnames(trio_binning_hg005)[2] = "trio_binning"
trio_binning_all <- bind_rows(
trio_binning_hg001 %>% mutate(dataset = "HG001"),
trio_binning_hg002 %>% mutate(dataset = "HG002"),
trio_binning_hg005 %>% mutate(dataset = "HG005")
)
head(trio_binning_all)
hifiasm_hg001 = read.delim("../../hifiasm_triomode/hg001_prediction_all.txt", header=FALSE, sep = " ")
hifiasm_hg002 = read.delim("../../hifiasm_triomode/hg002_prediction_all.txt", header=FALSE, sep = " ")
hifiasm_hg005 = read.delim("../../hifiasm_triomode/hg005_prediction_all.txt", header=FALSE, sep = " ")
colnames(hifiasm_hg001)[1] = "read_id"
colnames(hifiasm_hg001)[2] = "hifiasm"
colnames(hifiasm_hg002)[1] = "read_id"
colnames(hifiasm_hg002)[2] = "hifiasm"
colnames(hifiasm_hg005)[1] = "read_id"
colnames(hifiasm_hg005)[2] = "hifiasm"
hifiasm_hg001 <- hifiasm_hg001 %>%
mutate(hifiasm = as.character(hifiasm),
hifiasm = case_when(
hifiasm == "p" ~ "B",
hifiasm == "m" ~ "A",
hifiasm == "a" ~ "U",
TRUE ~ hifiasm
))
hifiasm_hg002 <- hifiasm_hg002 %>%
mutate(hifiasm = as.character(hifiasm),
hifiasm = case_when(
hifiasm == "p" ~ "B",
hifiasm == "m" ~ "A",
hifiasm == "a" ~ "U",
TRUE ~ hifiasm
))
hifiasm_hg005 <- hifiasm_hg005 %>%
mutate(hifiasm = as.character(hifiasm),
hifiasm = case_when(
hifiasm == "p" ~ "B",
hifiasm == "m" ~ "A",
hifiasm == "a" ~ "U",
TRUE ~ hifiasm
))
hifiasm_all <- bind_rows(
hifiasm_hg001 %>% mutate(dataset = "HG001"),
hifiasm_hg002 %>% mutate(dataset = "HG002"),
hifiasm_hg005 %>% mutate(dataset = "HG005")
)
hifiasm_all <- hifiasm_all %>% distinct()
head(hifiasm_all)
dfs <- list(hifiasm_all, trio_binning_all, no_norm_all, norm_all)
merged_all <- reduce(dfs, full_join, by = "read_id")
head(merged_all)
colnames(merged_all)[3]= "dataset"
merged_all$dataset.y= NULL
merged_all$dataset.y.y= NULL
merged_all$dataset.x.x= NULL
head(merged_all)
saveRDS(merged_all, "all_comparison.rds")
head(merged_all)
merged_all[!complete.cases(merged_all), ]
nrow(merged_all %>% filter(if_any(everything(), is.na)))
levels_order <- c("A","B","U","NA")
# 1) Preparar columnas y NA como categorÃ­a
merged_all2 <- merged_all %>%
mutate(
no_norm = fct_explicit_na(as.character(no_norm_trainv03), na_level = "NA"),
norm    = fct_explicit_na(as.character(norm_trainv03), na_level = "NA"),
no_norm = factor(no_norm, levels = levels_order),
norm    = factor(norm, levels = levels_order)
)
reticulate::repl_python()
